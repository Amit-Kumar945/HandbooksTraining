version: '2'
services:
  proxy1:
    build:
      context: userhost
      args:
        name: nginx
    stdin_open: true
    tty: true
  proxy2:
    build:
      context: userhost
      args:
        name: nginx
    stdin_open: true
    tty: true

  web1:
    build:
      context: userhost
      args:
        name: tomcat
    stdin_open: true
    tty: true
    privileged: true
  web2:
    build:
      context: userhost
      args:
        name: tomcat
    stdin_open: true
    tty: true
    privileged: true
  db:
    build:
      context: keyhost
    stdin_open: true
    tty: true
    privileged: true
  control-server:
    stdin_open: true
    build: control-server
    links:
      - proxy1
      - proxy2
      - web1
      - web2
      - db
